#!/bin/bash
#
#             UU                                                              
#         U   UU  UU                                                          
#         UU  UU  UU                                                          
#         UU  UU  UU  UU                                                      
#         UU  UU  UU  UU                                                      
#         UU  UUU UU  UU                                 Filesystem Builder   
#                                                                             
#         UUUUUUUUUUUUUU  DDDDDDDDDD         OOOOOOOO         OOOOOOOOO       
#    UUU  UUUUUUUUUUUUUU  DDDDDDDDDDDD     OOOOOOOOOOOO     OOOOOOOOOOOOO     
#     UUU UUUUUUUUUUUUUU  DDDDDDDDDDDDD  OOOOOOOOOOOOOOOO  OOOOOOOOOOOOOOOO   
#       UUUUUUUUUUUUUUUU  DDDDDDDDDDDDD  OOOOOOOOOOOOOOOO  OOOOOOOOOOOOOOOO   
#        UUUUUUUUUUUUUU   DDDDDDDDDDDDD  OOOOOOOOOOOOOOOO  OOOOOOOOOOOOOOOO   
#          UUUUUUUUUUUU   DDDDDDDDDDDD    OOOOOOOOOOOOOO    OOOOOOOOOOOOOO    
#           UUUUUUUUUU    DDDDDDDDDDD       OOOOOOOOOO        OOOOOOOOOO      
#
#   Author: Francesco Montefoschi <francesco.monte@gmail.com>
#   Author: Ettore Chimenti <ek5.chimenti@gmail.com>
#   Based on: Igor Peƒçovnik's work - https://github.com/igorpecovnik/lib
#   License: GNU GPL version 2
#
################################################################################

ROOTPWD="ubuntu"
USERNAMEPWD="udooer"
CPUMIN="392000"
CPUMAX="996000"
HOSTNAME="udooneo"
UBOOT="binary/uboot-neo-basicks.imx"
OUTPUT="udoobuntu-neo-basicks-desktop"
ROOTFS="udoo-neo" 
BUILD_DESKTOP="yes"


BASE_PACKAGES+=( linux-{image,firmware-image,dtb}-3.14.28-udooneo udhcpd
  firmware-udooneo-wl1831 udooneo-bluetooth udev-udooneo-rules 
  udooneo-m4uploader udoo-web-conf )

DESKTOP_PACKAGES+=( gnome-alsamixer arduino-core-udooneo )

UNWANTED_PACKAGES+=( pavucontrol pulseaudio )

UENV='
mmcroot=/dev/mmcblk0p2 rootwait rootfstype=ext4 rw uart_from_osc clk_ignore_unused cpuidle.off=1

fdt_file=dts/imx6sx-udoo-neo-basicks-hdmi-m4.dtb

m4last=/var/opt/m4/m4last.fw
m4fw=/m4startup.fw

m4last_cmd=ext2load mmc ${mmcdev}:2 0x84000000 ${m4last};
m4fw_cmd=fatload mmc ${mmcdev}:${mmcpart} 0x84000000 ${m4fw}; bootaux 0x84000000

uenvboot=if run m4last_cmd ; then bootaux 0x84000000 ; else run m4fw_cmd ; fi
'

